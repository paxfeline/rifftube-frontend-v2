{"ast":null,"code":"var _jsxFileName = \"/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/RiffControls/EditRiff.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport Record from './Record.js';\nimport { saveRiff, setPlayerMode, saveTempAudio, cancelEdit, EDIT_MODE } from '../../actions/index.js';\n\nclass EditRiff extends React.Component {\n  constructor(props) {\n    super(props);\n    this.durationField = React.createRef();\n    this.htmlPayloadField = React.createRef();\n    this.startTimeField = React.createRef();\n  }\n\n  render() {\n    console.log('ed rif red');\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-riff\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"edit-riff-inner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }\n    }, this.props.tempRiff.type === 'audio' ? /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 28,\n        columnNumber: 13\n      }\n    }, this.props.mode === EDIT_MODE && this.props.editIndex && !this.props.tempAudio ? /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 17\n      }\n    }, \"Loading...\") : null, /*#__PURE__*/React.createElement(Record, {\n      saveTempAudio: this.props.saveTempAudio,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 15\n      }\n    }), this.props.tempAudio ? /*#__PURE__*/React.createElement(\"button\", {\n      onClick: async () => {\n        debugger; // https://stackoverflow.com/questions/43620594/audio-blob-not-working-in-ios-safari\n        // answer by scottmizo\n\n        /*\n        var blob = this.props.tempAudio;\n        var audioContext = new (window.webkitAudioContext || window.AudioContext)();\n        var arrayBuffer = await (new Response(blob)).arrayBuffer();\n        audioContext.decodeAudioData(arrayBuffer, audioData => {\n          var source = audioContext.createBufferSource();\n          source.buffer = audioData;\n          source.connect(audioContext.destination);\n          source.start()\n        });\n        */\n\n        var audio = document.createElement('audio');\n        var source = document.createElement('source');\n        audio.appendChild(source);\n        audio.controls = false;\n        var audioURL = URL.createObjectURL(this.props.tempAudio);\n        source.src = audioURL;\n        audio.load(); //audio.src = audioURL;\n\n        audio.play();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36,\n        columnNumber: 17\n      }\n    }, \"Play\") : null, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 15\n      }\n    }, \"Start:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n      id: \"riff-start-field\",\n      defaultValue: this.props.tempRiff.time,\n      ref: this.startTimeField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      disabled: !this.props.tempAudio,\n      onClick: () => {\n        this.props.saveRiff(this.props.googleUser.getAuthResponse().id_token, {\n          payload: this.props.tempAudio,\n          time: Number(this.startTimeField.current.value)\n        }, this.props.tempRiff);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 15\n      }\n    }, \"Save\")) : /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 15\n      }\n    }, \"HTML payload:\"), /*#__PURE__*/React.createElement(\"textarea\", {\n      id: \"riff-edit-field\",\n      ref: this.htmlPayloadField,\n      defaultValue: this.props.tempRiff.payload,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 15\n      }\n    }, \"Duration:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n      id: \"riff-duration-field\",\n      defaultValue: this.props.tempRiff.duration || 2,\n      ref: this.durationField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 15\n      }\n    }, \"Start:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n      id: \"riff-start-field\",\n      defaultValue: this.props.tempRiff.time,\n      ref: this.startTimeField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        this.props.saveRiff(this.props.googleUser.getAuthResponse().id_token, {\n          payload: this.htmlPayloadField.current.value,\n          duration: Number(this.durationField.current.value),\n          time: Number(this.startTimeField.current.value)\n        }, this.props.tempRiff, this.props.websocket);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 15\n      }\n    }, \"Save\")), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        this.props.cancelEdit();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 11\n      }\n    }, \"Cancel\")));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  mode: state.mode,\n  tempRiff: state.riffs.temp,\n  tempAudio: state.riffsAudio.temp,\n  editIndex: state.riffs.editIndex,\n  googleUser: state.googleUser,\n  websocket: state.websocket\n});\n\nconst mapDispatchToProps = {\n  setPlayerMode,\n  saveRiff,\n  saveTempAudio,\n  cancelEdit\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(EditRiff);","map":{"version":3,"names":["React","connect","Record","saveRiff","setPlayerMode","saveTempAudio","cancelEdit","EDIT_MODE","EditRiff","Component","constructor","props","durationField","createRef","htmlPayloadField","startTimeField","render","console","log","tempRiff","type","mode","editIndex","tempAudio","audio","document","createElement","source","appendChild","controls","audioURL","URL","createObjectURL","src","load","play","time","googleUser","getAuthResponse","id_token","payload","Number","current","value","duration","websocket","mapStateToProps","state","riffs","temp","riffsAudio","mapDispatchToProps"],"sources":["/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/RiffControls/EditRiff.js"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport Record from './Record.js';\nimport {\n  saveRiff,\n  setPlayerMode,\n  saveTempAudio,\n  cancelEdit,\n  EDIT_MODE,\n} from '../../actions/index.js';\n\nclass EditRiff extends React.Component {\n  constructor(props) {\n    super(props);\n    this.durationField = React.createRef();\n    this.htmlPayloadField = React.createRef();\n    this.startTimeField = React.createRef();\n  }\n\n\n\n  render() {\n    console.log('ed rif red');\n    return (\n      <div className=\"edit-riff\">\n        <div className=\"edit-riff-inner\">\n          {this.props.tempRiff.type === 'audio' ? (\n            <React.Fragment>\n              {this.props.mode === EDIT_MODE &&\n              this.props.editIndex &&\n              !this.props.tempAudio ? (\n                <span>Loading...</span>\n              ) : null}\n              <Record saveTempAudio={this.props.saveTempAudio} />\n              {this.props.tempAudio ? (\n                <button\n                  onClick={async () => {\n                    debugger;\n                \n                    // https://stackoverflow.com/questions/43620594/audio-blob-not-working-in-ios-safari\n                    // answer by scottmizo\n                \n                    /*\n                    var blob = this.props.tempAudio;\n                    var audioContext = new (window.webkitAudioContext || window.AudioContext)();\n                    var arrayBuffer = await (new Response(blob)).arrayBuffer();\n                    audioContext.decodeAudioData(arrayBuffer, audioData => {\n                      var source = audioContext.createBufferSource();\n                      source.buffer = audioData;\n                      source.connect(audioContext.destination);\n                      source.start()\n                    });\n                    */\n                \n                    var audio = document.createElement('audio');\n                    var source = document.createElement('source');\n                    audio.appendChild(source);\n                \n                    audio.controls = false;\n                    var audioURL = URL.createObjectURL(this.props.tempAudio);\n                \n                    source.src = audioURL;\n                    audio.load();\n                \n                    //audio.src = audioURL;\n                    audio.play();\n                  }}\n                >\n                  Play\n                </button>\n              ) : null}\n              <br />\n              <div>\n                Start:{' '}\n                <input\n                  id=\"riff-start-field\"\n                  defaultValue={this.props.tempRiff.time}\n                  ref={this.startTimeField}\n                />\n              </div>\n              <button\n                disabled={!this.props.tempAudio}\n                onClick={() => {\n                  this.props.saveRiff(\n                    this.props.googleUser.getAuthResponse().id_token,\n                    {\n                      payload: this.props.tempAudio,\n                      time: Number(this.startTimeField.current.value),\n                    },\n                    this.props.tempRiff\n                  );\n                }}\n              >\n                Save\n              </button>\n            </React.Fragment>\n          ) : (\n            <React.Fragment>\n              <div>HTML payload:</div>\n              <textarea\n                id=\"riff-edit-field\"\n                ref={this.htmlPayloadField}\n                defaultValue={this.props.tempRiff.payload}\n              />\n\n              <div>\n                Duration:{' '}\n                <input\n                  id=\"riff-duration-field\"\n                  defaultValue={this.props.tempRiff.duration || 2}\n                  ref={this.durationField}\n                />\n              </div>\n              <div>\n                Start:{' '}\n                <input\n                  id=\"riff-start-field\"\n                  defaultValue={this.props.tempRiff.time}\n                  ref={this.startTimeField}\n                />\n              </div>\n              <button\n                onClick={() => {\n                  this.props.saveRiff(\n                    this.props.googleUser.getAuthResponse().id_token,\n                    {\n                      payload: this.htmlPayloadField.current.value,\n                      duration: Number(this.durationField.current.value),\n                      time: Number(this.startTimeField.current.value),\n                    },\n                    this.props.tempRiff,\n                    this.props.websocket\n                  );\n                }}\n              >\n                Save\n              </button>\n            </React.Fragment>\n          )}\n\n          <button\n            onClick={() => {\n              this.props.cancelEdit();\n            }}\n          >\n            Cancel\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  mode: state.mode,\n  tempRiff: state.riffs.temp,\n  tempAudio: state.riffsAudio.temp,\n  editIndex: state.riffs.editIndex,\n  googleUser: state.googleUser,\n  websocket: state.websocket,\n});\n\nconst mapDispatchToProps = {\n  setPlayerMode,\n  saveRiff,\n  saveTempAudio,\n  cancelEdit,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(EditRiff);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}