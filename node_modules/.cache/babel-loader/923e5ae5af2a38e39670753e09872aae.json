{"ast":null,"code":"var _jsxFileName = \"/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/ViewInterface/AuthorSelector.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport ViewFilter from './ViewFilter';\n\nclass AuthorSelector extends React.Component {\n  constructor(_props) {\n    super(_props);\n\n    this.setMute = (id, mute) => {\n      this.setState((state, props) => {\n        // new state\n        const m = { ...state.muted,\n          [id]: mute\n        }; // const temp = props.riffs.filter((el) => !m[el.user_id]);\n\n        return {\n          muted: m,\n          filteredRiffs: props.riffs.filter(el => !m[el.user_id]),\n          all: false\n        };\n      });\n    };\n\n    this.toggleMute = id => {\n      //this.setMute(id, !this.state.muted[id]);\n      debugger;\n      const m = { ...this.state.muted,\n        [id]: !this.state.muted[id]\n      }; // not muted\n\n      const nm2 = this.state.names.map(el => el.id);\n      const nm = nm2.filter(el => !m[el]);\n      const nmStr = '?solo=' + nm.join(',');\n      this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n    };\n\n    this.state = {\n      names: [],\n      muted: {},\n      filteredRiffs: [],\n      all: true\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    debugger;\n    /*\n    if (\n      prevState.muted !== this.state.muted ||\n      prevState.all !== this.state.all\n    ) {\n      if (this.state.all) {\n        this.props.history.push(`/view/${this.props.videoID}`);\n      } else {\n        // new muted state\n        const m = { ...this.state.muted };\n         // not muted\n        const nm2 = this.state.names.map((el) => el.id);\n        const nm = nm2.filter((el) => !m[el]);\n        const nmStr = '?solo=' + nm.join(',');\n         this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n      }\n    }\n    */\n\n    const rifferList = this.props.riffers ? this.props.riffers.indexOf(',') >= 0 ? this.props.riffers.split(',') : [this.props.riffers] : [];\n\n    if (prevProps.riffers !== this.props.riffers) {\n      const m = {};\n      this.state.names.forEach(el => {\n        m[el.id] = !(rifferList.includes(String(el.id)) || this.props.riffers === undefined);\n      });\n      this.setState({\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs: this.props.riffs.filter(el => !m[el.user_id])\n      });\n    }\n\n    if (prevProps.timestamp !== this.props.timestamp || prevProps.riffs.length === 0 && this.props.riffs.length > 0) {\n      //( prevProps.riffs !== this.props.riffs )\n      const includes = (arr, id) => arr.some(el => el.id === id);\n\n      var names = [...this.state.names];\n      const m = { ...this.state.muted\n      };\n      this.props.riffs.forEach(riff => {\n        if (!includes(names, riff.user_id)) {\n          names.push({\n            name: riff.name,\n            id: riff.user_id\n          });\n\n          if (this.props.riffers !== undefined) {\n            m[riff.user_id] = !rifferList.some(riffer => riff.user_id === Number(riffer));\n          }\n        }\n      });\n      this.setState({\n        names,\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs: this.props.riffers === undefined ? this.props.riffs : this.props.riffs.filter(el => !m[el.user_id])\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ViewFilter, {\n      id: this.props.videoID,\n      duration: this.props.duration,\n      riffs: this.state.filteredRiffs,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      onClick: () => {\n        if (!this.state.all) this.props.history.push(`/view/${this.props.videoID}`);else {\n          const nm2 = this.state.names.map(el => el.id);\n          const nm = nm2.filter(el => !this.state.muted[el]);\n          const nmStr = nm.join(',');\n          this.props.history.push(`/view/${this.props.videoID}?solo=${nmStr}`);\n        }\n      },\n      style: {\n        backgroundColor: this.state.all ? 'blue' : 'gray'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 9\n      }\n    }, \"All\"), this.state.names.map(el => /*#__PURE__*/React.createElement(\"div\", {\n      key: el.id,\n      onClick: () => this.toggleMute(el.id),\n      style: {\n        backgroundColor: this.state.muted[el.id] ? 'gray' : 'blue'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }\n    }, el.name)));\n  }\n\n}\n\nconst mapStateToProps = state => ({\n  timestamp: state.riffs.timestamp\n});\n\nexport default connect(mapStateToProps, null)(AuthorSelector);","map":{"version":3,"names":["React","connect","ViewFilter","AuthorSelector","Component","constructor","props","setMute","id","mute","setState","state","m","muted","filteredRiffs","riffs","filter","el","user_id","all","toggleMute","nm2","names","map","nm","nmStr","join","history","push","videoID","componentDidUpdate","prevProps","prevState","rifferList","riffers","indexOf","split","forEach","includes","String","undefined","timestamp","length","arr","some","riff","name","riffer","Number","render","duration","backgroundColor","mapStateToProps"],"sources":["/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/ViewInterface/AuthorSelector.js"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport ViewFilter from './ViewFilter';\n\nclass AuthorSelector extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { names: [], muted: {}, filteredRiffs: [], all: true };\n  }\n\n  setMute = (id, mute) => {\n    this.setState((state, props) => {\n      // new state\n      const m = { ...state.muted, [id]: mute };\n\n      // const temp = props.riffs.filter((el) => !m[el.user_id]);\n\n      return {\n        muted: m,\n        filteredRiffs: props.riffs.filter((el) => !m[el.user_id]),\n        all: false,\n      };\n    });\n  };\n\n  toggleMute = (id) => {\n    //this.setMute(id, !this.state.muted[id]);\n\n    debugger;\n\n    const m = { ...this.state.muted, [id]: !this.state.muted[id] };\n\n    // not muted\n    const nm2 = this.state.names.map((el) => el.id);\n    const nm = nm2.filter((el) => !m[el]);\n    const nmStr = '?solo=' + nm.join(',');\n\n    this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n  };\n\n  componentDidUpdate(prevProps, prevState) {\n    debugger;\n\n    /*\n    if (\n      prevState.muted !== this.state.muted ||\n      prevState.all !== this.state.all\n    ) {\n      if (this.state.all) {\n        this.props.history.push(`/view/${this.props.videoID}`);\n      } else {\n        // new muted state\n        const m = { ...this.state.muted };\n\n        // not muted\n        const nm2 = this.state.names.map((el) => el.id);\n        const nm = nm2.filter((el) => !m[el]);\n        const nmStr = '?solo=' + nm.join(',');\n\n        this.props.history.push(`/view/${this.props.videoID}${nmStr}`);\n      }\n    }\n    */\n\n    const rifferList = this.props.riffers\n      ? this.props.riffers.indexOf(',') >= 0\n        ? this.props.riffers.split(',')\n        : [this.props.riffers]\n      : [];\n\n    if (prevProps.riffers !== this.props.riffers) {\n      const m = {};\n      this.state.names.forEach((el) => {\n        m[el.id] = !(\n          rifferList.includes(String(el.id)) || this.props.riffers === undefined\n        );\n      });\n      this.setState({\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs: this.props.riffs.filter((el) => !m[el.user_id]),\n      });\n    }\n\n    if (\n      prevProps.timestamp !== this.props.timestamp ||\n      (prevProps.riffs.length === 0 && this.props.riffs.length > 0)\n    ) {\n      //( prevProps.riffs !== this.props.riffs )\n      const includes = (arr, id) => arr.some((el) => el.id === id);\n\n      var names = [...this.state.names];\n\n      const m = { ...this.state.muted };\n\n      this.props.riffs.forEach((riff) => {\n        if (!includes(names, riff.user_id)) {\n          names.push({ name: riff.name, id: riff.user_id });\n\n          if (this.props.riffers !== undefined) {\n            m[riff.user_id] = !rifferList.some(\n              (riffer) => riff.user_id === Number(riffer)\n            );\n          }\n        }\n      });\n      this.setState({\n        names,\n        muted: m,\n        all: this.props.riffers === undefined,\n        filteredRiffs:\n          this.props.riffers === undefined\n            ? this.props.riffs\n            : this.props.riffs.filter((el) => !m[el.user_id]),\n      });\n    }\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <ViewFilter\n          id={this.props.videoID}\n          duration={this.props.duration}\n          riffs={this.state.filteredRiffs}\n        />\n        <div\n          onClick={() => {\n            if (!this.state.all)\n              this.props.history.push(`/view/${this.props.videoID}`);\n            else {\n              const nm2 = this.state.names.map((el) => el.id);\n              const nm = nm2.filter((el) => !this.state.muted[el]);\n              const nmStr = nm.join(',');\n\n              this.props.history.push(\n                `/view/${this.props.videoID}?solo=${nmStr}`\n              );\n            }\n          }}\n          style={{\n            backgroundColor: this.state.all ? 'blue' : 'gray',\n          }}\n        >\n          All\n        </div>\n        {this.state.names.map((el) => (\n          <div\n            key={el.id}\n            onClick={() => this.toggleMute(el.id)}\n            style={{\n              backgroundColor: this.state.muted[el.id] ? 'gray' : 'blue',\n            }}\n          >\n            {el.name}\n          </div>\n        ))}\n      </React.Fragment>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => ({\n  timestamp: state.riffs.timestamp,\n});\n\nexport default connect(mapStateToProps, null)(AuthorSelector);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}