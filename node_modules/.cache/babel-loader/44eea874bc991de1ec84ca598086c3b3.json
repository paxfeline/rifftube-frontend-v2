{"ast":null,"code":"var _jsxFileName = \"/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/YouTubeVideo/AllowPlayback.js\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { setPlayerMode, PLAY_MODE } from '../../actions/index.js';\n\nclass AllowPlayback extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      var test = new Audio();\n      test.controls = false;\n      test.src = '/dingdong.wav';\n      test.play().then(() => {\n        this.setupAudioPlayers();\n      }).catch(() => {\n        console.error('playback not allowed');\n      });\n    };\n\n    this.setupAudioPlayers = () => {\n      this.setState({\n        allowed: true\n      });\n      window.audioContexts = [];\n      window.audioPlayers = [];\n      window.audioPlayerUse = [];\n      window.audioPlayersCount = 5;\n\n      for (let i = 0; i < 5; i++) {\n        window.audioContexts[i] = new (window.AudioContext || window.webkitAudioContext)();\n        window.audioPlayers[i] = new Audio(); // should be identical behavior to: document.createElement('audio');\n\n        window.audioPlayers[i].controls = false;\n        window.audioPlayers[i].addEventListener('ended', function () {\n          this.inUse = false;\n        });\n        let se = document.createElement('source');\n        window.audioPlayers[i].appendChild(se);\n        window.audioPlayers[i].srcEl = se;\n      }\n    };\n\n    this.render = () => {\n      //if (!this.state) return null;\n      return !this.state.allowed ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"audio-capture\",\n        onClick: () => {\n          this.setupAudioPlayers();\n          this.props.setPlayerMode(PLAY_MODE);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 7\n        }\n      }) : null;\n    };\n\n    this.state = {\n      allowed: false\n    };\n  }\n\n}\n\nconst mapStateToProps = state => ({});\n\nconst mapDispatchToProps = {\n  setPlayerMode\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(AllowPlayback);","map":{"version":3,"names":["React","connect","setPlayerMode","PLAY_MODE","AllowPlayback","Component","constructor","props","componentDidMount","test","Audio","controls","src","play","then","setupAudioPlayers","catch","console","error","setState","allowed","window","audioContexts","audioPlayers","audioPlayerUse","audioPlayersCount","i","AudioContext","webkitAudioContext","addEventListener","inUse","se","document","createElement","appendChild","srcEl","render","state","mapStateToProps","mapDispatchToProps"],"sources":["/Users/davidnewberry/Documents/rifftube-git/RiffTube/front-end/src/components/YouTubeVideo/AllowPlayback.js"],"sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport { setPlayerMode, PLAY_MODE } from '../../actions/index.js';\n\nclass AllowPlayback extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { allowed: false };\n  }\n\n  componentDidMount = () => {\n    var test = new Audio();\n    test.controls = false;\n    test.src = '/dingdong.wav';\n    test\n      .play()\n      .then(() => {\n        this.setupAudioPlayers();\n      })\n      .catch(() => {\n        console.error('playback not allowed');\n      });\n  };\n\n  setupAudioPlayers = () => {\n    this.setState({ allowed: true });\n    window.audioContexts = [];\n    window.audioPlayers = [];\n    window.audioPlayerUse = [];\n    window.audioPlayersCount = 5;\n    for (let i = 0; i < 5; i++) {\n      window.audioContexts[i] = new (window.AudioContext ||\n        window.webkitAudioContext)();\n\n      window.audioPlayers[i] = new Audio(); // should be identical behavior to: document.createElement('audio');\n      window.audioPlayers[i].controls = false;\n      window.audioPlayers[i].addEventListener('ended', function () {\n        this.inUse = false;\n      });\n\n      let se = document.createElement('source');\n      window.audioPlayers[i].appendChild(se);\n      window.audioPlayers[i].srcEl = se;\n    }\n  };\n\n  render = () => {\n    //if (!this.state) return null;\n\n    return !this.state.allowed ? (\n      <div\n        className=\"audio-capture\"\n        onClick={() => {\n          this.setupAudioPlayers();\n          this.props.setPlayerMode(PLAY_MODE);\n        }}\n      />\n    ) : null;\n  };\n}\n\nconst mapStateToProps = (state) => ({});\n\nconst mapDispatchToProps = {\n  setPlayerMode,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AllowPlayback);\n"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,SAASC,aAAT,EAAwBC,SAAxB,QAAyC,wBAAzC;;AAEA,MAAMC,aAAN,SAA4BJ,KAAK,CAACK,SAAlC,CAA4C;EAC1CC,WAAW,CAACC,KAAD,EAAQ;IACjB,MAAMA,KAAN;;IADiB,KAKnBC,iBALmB,GAKC,MAAM;MACxB,IAAIC,IAAI,GAAG,IAAIC,KAAJ,EAAX;MACAD,IAAI,CAACE,QAAL,GAAgB,KAAhB;MACAF,IAAI,CAACG,GAAL,GAAW,eAAX;MACAH,IAAI,CACDI,IADH,GAEGC,IAFH,CAEQ,MAAM;QACV,KAAKC,iBAAL;MACD,CAJH,EAKGC,KALH,CAKS,MAAM;QACXC,OAAO,CAACC,KAAR,CAAc,sBAAd;MACD,CAPH;IAQD,CAjBkB;;IAAA,KAmBnBH,iBAnBmB,GAmBC,MAAM;MACxB,KAAKI,QAAL,CAAc;QAAEC,OAAO,EAAE;MAAX,CAAd;MACAC,MAAM,CAACC,aAAP,GAAuB,EAAvB;MACAD,MAAM,CAACE,YAAP,GAAsB,EAAtB;MACAF,MAAM,CAACG,cAAP,GAAwB,EAAxB;MACAH,MAAM,CAACI,iBAAP,GAA2B,CAA3B;;MACA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;QAC1BL,MAAM,CAACC,aAAP,CAAqBI,CAArB,IAA0B,KAAKL,MAAM,CAACM,YAAP,IAC7BN,MAAM,CAACO,kBADiB,GAA1B;QAGAP,MAAM,CAACE,YAAP,CAAoBG,CAApB,IAAyB,IAAIhB,KAAJ,EAAzB,CAJ0B,CAIY;;QACtCW,MAAM,CAACE,YAAP,CAAoBG,CAApB,EAAuBf,QAAvB,GAAkC,KAAlC;QACAU,MAAM,CAACE,YAAP,CAAoBG,CAApB,EAAuBG,gBAAvB,CAAwC,OAAxC,EAAiD,YAAY;UAC3D,KAAKC,KAAL,GAAa,KAAb;QACD,CAFD;QAIA,IAAIC,EAAE,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAT;QACAZ,MAAM,CAACE,YAAP,CAAoBG,CAApB,EAAuBQ,WAAvB,CAAmCH,EAAnC;QACAV,MAAM,CAACE,YAAP,CAAoBG,CAApB,EAAuBS,KAAvB,GAA+BJ,EAA/B;MACD;IACF,CAvCkB;;IAAA,KAyCnBK,MAzCmB,GAyCV,MAAM;MACb;MAEA,OAAO,CAAC,KAAKC,KAAL,CAAWjB,OAAZ,gBACL;QACE,SAAS,EAAC,eADZ;QAEE,OAAO,EAAE,MAAM;UACb,KAAKL,iBAAL;UACA,KAAKR,KAAL,CAAWL,aAAX,CAAyBC,SAAzB;QACD,CALH;QAAA;QAAA;UAAA;UAAA;UAAA;QAAA;MAAA,EADK,GAQH,IARJ;IASD,CArDkB;;IAEjB,KAAKkC,KAAL,GAAa;MAAEjB,OAAO,EAAE;IAAX,CAAb;EACD;;AAJyC;;AAyD5C,MAAMkB,eAAe,GAAID,KAAD,KAAY,EAAZ,CAAxB;;AAEA,MAAME,kBAAkB,GAAG;EACzBrC;AADyB,CAA3B;AAIA,eAAeD,OAAO,CAACqC,eAAD,EAAkBC,kBAAlB,CAAP,CAA6CnC,aAA7C,CAAf"},"metadata":{},"sourceType":"module"}